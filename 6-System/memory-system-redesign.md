---
para: system
type: 系统设计文档
status: superseded
tags: [系统设计, 记忆系统, 决策文档]
summary: 外挂大脑记忆系统改造的决策文档。范围：文件结构调整+CLAUDE.md更新+Skill调整+bug修复+自动注入优化分析。每个改动点含批判性分析。
created: 2026-02-25
updated: 2026-02-25
---

> 版本：v4 | 更新日期：2026-02-25
> 变更：修正6处工程问题 + 新增自动注入优化视角
>
> ⚠️ **已被命名迁移方案 supersede（2026-02-25）**
> 本文档描述阶段零～阶段四的改造决策，保留作历史记录。
> 后续命名迁移（memory/→working-memory/，MEMORY.md→OPERATING_RULES.md，新增5-Identity/MEMORY.md）已在独立 commit 中完成，不在本文档范围内。

# 记忆系统改造：决策文档

---

## 第一部分：背景与诊断

**问题1：MEMORY.md 和 5-Identity 内容重叠，AI不知道读哪个。**
MEMORY.md 里的"长期偏好/长期目标/关键约束"在 TELOS.md 和 AI_RULES.md 里已经有了，AI 读到两份说同一件事的文件，要么重复依赖、要么随机忽视一个，行为不可预测。

**问题2：5-Identity 缺少一个存放 AI 观察到的场景化偏好的地方。**
写作品味、审美倾向、AI交互要求这类内容——不是用户主动声明的身份，是 AI 从行为中推断出来的偏好——现在没有归宿，要么挤进 MEMORY.md（语义不清），要么每次对话用完就丢失。

**问题3：没有任务智能层：成功的交互方式无法积累成可复用模式。**
每次复杂任务成功完成，经验直接消失，下次同类任务从零摸索。

**问题4：AI 进入目录时靠 CLAUDE.md 理解职责，但新增的 PROFILE.md 和 patterns/ 还没写进去，所以AI看不到。**
新文件建了但 L2 没有登记，违反系统铁律，AI 会把新文件当未知内容处理。

**问题5：现有自动化脚本与新结构不兼容。**
`memory_consolidate.py` 硬编码 MEMORY.md 路径；`/digest` SKILL.md 的写入表格目标是 MEMORY.md。不同步更新这两个，系统跑起来还是按旧语义写，文档和行为会再次分叉。

**问题6：approve_change.sh 和 pending_approvals.md 格式不匹配（现有 bug）。**
脚本（第42行）搜索 `## 提案 #`，文件里实际是 `### 提案 #`（三个#）。字段格式也不匹配：脚本（第83行）期待 `- 类型：`，文件里是 `- **类型**:`。脚本目前大概率从未成功运行过。这个 bug 与本次重设计无关，但如果新的偏好冲突升级走 B 类审批，依赖这个脚本的话会断。

---

## 第二部分：逐项改动

---

## 改动1：新建 5-Identity/PROFILE.md

**改什么**：在 5-Identity/ 目录下新建 PROFILE.md，专门存 AI 从对话行为中观察推断出的场景化偏好。内容包括写作品味、审美倾向、对 AI 回复形式的要求、不同任务下的具体偏好。这不是用户主动声明的身份（TELOS 的职责），是 AI 观察推断的。

初始模板：

```markdown
---
para: identity
type: 系统文档
status: active
tags: [奥一, AI偏好, 场景化偏好]
summary: AI从对话中观察到的场景化偏好。A类写入，发现冲突时升B类。
update_level: A
---

# PROFILE - 场景化偏好档案

> AI从对话行为中观察推断。
> 写入：观察到新偏好→直接写入；与已有条目冲突→先尝试场景化；场景化失败→升B类审批。

## AI交互偏好
- 回复风格：简洁直接，结论前置
- 分析方式：先给结论再讲逻辑，不要铺垫
- 理解方式：偏好用类比理解抽象概念

## 写作与表达偏好
- 接地气具体类比 > 泛泛而谈
- 情感节点要有画面感
- 带身份感：用"普通人"让读者觉得是写给自己的
- 金句锋利直接，不留余地
- 结尾给愿景，不用互动CTA收尾
- 基调：内容要硬，表达要人

## 任务执行偏好
- 新任务：先给方案再执行
- 系统配置：优先一次性永久方案

## 学习理解偏好
- 先理解原理再接受方案
- 倾向用类比理解复杂概念
```

**如果做了**：
- 体验变化：AI 说"我注意到你喜欢X"时，有专属位置真正写下来，下次 session 加载这个文件直接生效，不用每次重新观察。你会感觉 AI 越来越"懂你"。
- 好处：偏好有了专属归属地，不和 TELOS 的使命级内容混在一起，语义清晰；冲突检测有了"锚点"——AI 写入新观察时可以和现有条目比对，决定是合并还是升级审批。
- 坏处/风险：首次创建是 B 类审批（5-Identity 目录下任何新文件都要审批，这是铁律）；多了一个文件要日常维护；如果 AI 基于不典型的一次性行为写入了错误观察，你大概率不会主动去检查，错误偏好会悄悄影响后续 session。
- 维护负担：A 类写入，AI 直接写，用户不需要主动操作。创建一次之后是自动维护。

**如果不做**：
偏好要么继续堆在 MEMORY.md（和 TELOS 的职责重叠，AI 语义困惑），要么根本不存（每次对话观察到的偏好直接流失，AI 永远停在"初次见面"模式）。

**建议**：做。这是整套改造里成本最低、价值最清晰的一步。需要 B 类审批一次，之后自然积累。

---

## 改动2：更新 5-Identity/CLAUDE.md（L2）

**改什么**：在 5-Identity 的 L2 成员清单里加入 PROFILE.md 条目，说明职责、写入级别和冲突处理规则。同时在变更分级说明里明确 PROFILE.md 是 A 类写入、冲突升 B 类的规则。

**重要修正**：5-Identity/CLAUDE.md 第8行现在写着"此目录的任何变更必须经过人工审批"——这是错误的/过时的。CONTEXT.md 已经是 A 类（自动更新），PROFILE.md（新增）也将是 A 类例外。这行需要删除或修正为"文件级分级见下表"。每个文件的变更级别在成员清单里单独标注。

改完后的成员清单格式：

```
- TELOS.md: 身份框架（使命/目标/挑战/策略/信念）→ B类审批
- AI_RULES.md: AI行为准则 → B类审批
- CONTEXT.md: 动态上下文 → A类自动
- PROFILE.md: 场景化偏好（AI观察到的品味/偏好/交互要求）→ A类写入，冲突升B类
```

**如果做了**：
- 体验变化：AI 进入 5-Identity/ 时读到准确的局部地图，知道 PROFILE.md 的存在、职责和写入规则，不会把它当未知文件或跳过它。同时"任何变更必须审批"的错误规则被修正，AI 不会在 CONTEXT.md 自动更新时产生困惑。
- 好处：符合系统铁律（新文件必须登记 L2），AI 行为可预测；消除误导性规则。
- 坏处/风险：风险极低。这是局部地图更新，改错了最多导致 AI 对这个目录有小范围误解，不影响整个系统。
- 维护负担：和改动1同步完成，一次性。

**如果不做**：
PROFILE.md 建了但 L2 没有登记，违反系统铁律（"L2 不完整 - 存在未列入清单的文件"属于重罪）。AI 进这个目录时看不到 PROFILE.md 的说明，大概率把它当无关文件处理，新建的文件形同虚设。

**建议**：必须做，和改动1捆绑执行，成本几乎为零。

---

## 改动3：新建 candidates.md，MEMORY.md 保持现有角色

**改什么**：
不改造 MEMORY.md。新建 `6-System/memory/candidates.md`，作为 AI 观察到新偏好的暂存区。
MEMORY.md 继续在 contextFiles 里，继续存已确认的稳定规则。

原因：MEMORY.md 现在在 settings.json contextFiles 里（自动注入）。
如果把它改成"候选池"，每次 session 会把未确认的 AI 推断当成已知事实注入，污染决策。

新的单一写入路径：
```
AI 对话中观察到新偏好
  → 写入 candidates.md（NOT in contextFiles，不注入）
  → /digest 触发时：用户确认 → 晋升到 PROFILE.md 或 MEMORY.md
                 冲突 → 升 B 类写 pending_approvals.md
```

candidates.md 内容格式：

```markdown
---
# 偏好候选池

> AI 观察到的新偏好暂存于此。不自动注入上下文。
> 晋升：通过 /digest 确认后写入 PROFILE.md 或 MEMORY.md。
> 清理：晋升或否决后删除对应条目。

## 待确认候选
（AI 直接追加，格式：`- [日期] 观察：[内容] | 来源：[对话主题]`）
```

注意：6-System/ 下已有 `candidates/` 目录（用于 identity/ 和 resources/ 候选），这是不同的机制。`candidates.md` 是 `6-System/memory/` 下的偏好暂存文件，和 `6-System/candidates/` 目录并列存在，职责不同，命名上需注意区分。

同时，原 v3 设计的"将 MEMORY.md 重定位为暂存区"不执行，理由如上。MEMORY.md 继续作为操作性规则和已确认偏好的归宿，内容迁移方案（删除与 TELOS/AI_RULES 重叠的条目、将写作风格偏好迁移到 PROFILE.md）仍然需要执行，但 MEMORY.md 的定位是"已确认的操作性规则"，不是"候选池"。

**如果做了**：
- 体验变化：MEMORY.md 只有已确认的东西，AI 每次读到的都是可信信息
- 好处：消除"AI 把自己的推断当成你的事实"这个风险
- 坏处：多了一个文件；candidates.md 里的东西如果你从不触发 /digest，会积累
- 维护负担：candidates.md 靠 AI 自动写入，晋升靠 /digest 手动触发

**如果不做**：
- MEMORY.md 同时装确认的和未确认的，下次 session 的 AI 不知道哪些可信

**建议**：做。这是整套架构里最重要的一个修正。

---

## 改动4（新）：更新 settings.json contextFiles

**改什么**：
在 contextFiles 里加入 PROFILE.md：

```json
"contextFiles": [
  "5-Identity/TELOS.md",
  "5-Identity/AI_RULES.md",
  "5-Identity/CONTEXT.md",
  "5-Identity/PROFILE.md",
  "6-System/memory/MEMORY.md"
]
```

**如果做了**：
- 体验变化：下次 session 启动时 Claude 自动读到 PROFILE.md，写进去的偏好立刻生效
- 如果不加：PROFILE.md 永远是死文件，所有写进去的观察对下次 session 完全无效

**如果不做**：
- 建 PROFILE.md 等于白建，"AI 越来越懂你"这个核心收益不会发生

**建议**：必须做，和改动1（新建 PROFILE.md）同时执行。

---

## 改动5：更新 6-System/memory/CLAUDE.md（L2）

**改什么**：把 MEMORY.md 的职责描述更新为"已确认的操作性规则和稳定偏好"，加入 candidates.md 的说明：作为 AI 观察新偏好的暂存区，不注入上下文，通过 /digest 晋升。

**如果做了**：
- 体验变化：AI 读取 memory/ 目录时，对 MEMORY.md 和 candidates.md 的定位理解准确，知道 MEMORY.md 里面的内容是"定论"，candidates.md 是"候选"，不会过度权威化候选内容。
- 好处：L2 职责描述和改动3的新结构保持同构，系统认知一致。
- 坏处/风险：风险极低，局部地图更新。
- 维护负担：和改动3同步完成，一次性。

**如果不做**：
新文件建了但 L2 没有登记，违反系统铁律。

**建议**：必须做，和改动3捆绑执行。

---

## 改动6：新建 6-System/patterns/ 目录 + CLAUDE.md

**改什么**：在 6-System/ 下新建 patterns/ 目录，建立 patterns/CLAUDE.md（L2），定义任务智能积累的职责和写入规则。

patterns/CLAUDE.md 内容：

```markdown
# 6-System/patterns/
> L2 | 父级: /6-System/CLAUDE.md

## 职责

任务智能积累：存放成功的任务执行模式，可复用的交互策略。

## 什么时候写入

- 复杂任务成功完成后，AI识别到有价值的执行方法
- 用户明确说"这次做法很好，记下来"
- /digest 触发时，AI从对话中识别可复用模式

## 文件命名

`[任务类型]-[具体方法].md`
例：`writing-口播稿创作流程.md`、`research-竞品分析框架.md`

## 现有模式

（目录初始为空，随使用逐步积累）
```

**如果做了**：
- 体验变化：每次成功的复杂交互有了可沉淀的位置。下次遇到类似任务，AI 可以加载对应 pattern，而不是从零摸索。理论上随时间积累，复杂任务的执行质量会持续提升。
- 好处：把成功经验从"一次性消耗"变成"可积累资产"，是整套系统最有价值的闭环之一；建立目录结构的成本极低（只需新建文件）。
- 坏处/风险：**这是所有改动里落地最难的一个——谁来写，什么时候写？** 如果靠 AI 自动判断"这次任务值得沉淀"并写入，AI 的判断质量不稳定，可能大量写入没用的东西；如果靠用户主动触发，根据经验，任务完成后注意力已转移，这一步大概率不会发生。没有明确触发机制，这个目录大概率会一直空着——这是这套方案最可能失败的地方。
- 维护负担：目录和 L2 建立是一次性低成本操作；实际内容填充需要持续输入，触发方式先靠手动（用户说"记下来"或 /digest 时提取）。

**如果不做**：
成功的任务经验继续消失，但这是现状，你一直在这个状态下工作。短期不会感受到缺失，只是错过了积累的机会。

**建议**：建立目录结构（低成本），但不要期望这个功能会立刻被填充。先创造条件，触发方式先靠手动，观察真正有价值的模式自然浮现。不要为了"应该沉淀"而强迫沉淀，那会生产低质量内容。

---

## 改动7：更新 6-System/CLAUDE.md（L2）

**改什么**：在 6-System/ 的 L2 目录结构里加入 `patterns/` 的说明条目，同时把 MEMORY.md 的职责描述改为"已确认的操作性规则和稳定偏好"，加入 candidates.md 的说明。

**如果做了**：
- 体验变化：AI 进入 6-System/ 时能读到准确的目录地图，知道 patterns/ 的存在和职责，知道 candidates.md 是偏好暂存区。
- 好处：L2 目录结构和实际文件系统同构，符合系统原则。
- 坏处/风险：风险极低。
- 维护负担：和改动5、6同步完成，一次性。

**如果不做**：
patterns/ 目录建了但 6-System 的 L2 没有登记，违反系统铁律。

**建议**：必须做，和改动5、6捆绑执行。

---

## 改动8：升级 /digest skill

**改什么**：升级 /digest 指令，让它在当前对话结束时执行完整的知识提炼和状态更新，而不是现在的不完整实现。

升级后的完整行为：
1. 读取最近 daily 文件（可选，取决于用户是否需要跨 session 整合）
2. 提炼本次对话的关键决策、状态变化、重要产出
3. 更新 CONTEXT.md（A 类）
4. 读取 candidates.md，展示候选条目让用户确认：
   - 确认的条目写入 PROFILE.md 或 MEMORY.md，从 candidates.md 删除
   - 否决的条目从 candidates.md 删除
5. 识别到新偏好 → 写入 candidates.md（而非直接写 MEMORY.md）
6. 识别到可复用任务模式 → 写入 patterns/（A 类）
7. 识别到身份级变化 → 写入 pending_approvals.md（B 类）

同时更新 /digest SKILL.md 写入目标表：

| 类型 | 识别信号 | 目标位置 |
|------|----------|----------|
| 项目上下文 | 新项目、阶段变化、产品定义、目标人群、关键决策 | `5-Identity/CONTEXT.md` |
| 新观察到的偏好（未确认） | 在本次对话中首次观察到的工作习惯、交互偏好 | `6-System/memory/candidates.md` |
| 已确认的稳定偏好 | 通过本次 /digest 用户确认的候选条目 | `5-Identity/PROFILE.md` 或 `6-System/memory/MEMORY.md` |
| 可复用知识 | 方法论、框架、模板、经验教训 | PARA 对应位置（走 intake 流程） |
| Identity 相关 | 使命/目标/信念/策略变化 | `6-System/pending_approvals.md`（B类审批） |

**如果做了**：
- 体验变化：手动说一次 /digest，系统状态就更新了。下次新 session 启动时，AI 读到的是整理过的最新状态，而不是几周前的快照。对话的连续感明显提升，AI 会感觉越来越"懂你"。
- 好处：这是整套系统唯一的"闭环节点"，没有它，PROFILE.md 和 patterns/ 只是空壳；/digest 是让所有新结构真正活起来的触发器；手动触发意味着用户有完全控制权，不会意外消耗资源。candidates.md 的晋升逻辑也在这里落地，偏好流转路径完整。
- 坏处/风险：调用 AI 做提炼需要 token，估计每次 1000-3000 token（取决于对话长度），约相当于一次中等对话的消耗；如果 /digest 写入质量差（比如误判偏好或错误总结决策），CONTEXT.md 被覆写成错误内容是最严重的风险，需要备份机制兜底。
- 维护负担：手动触发，用户有控制权；建议每 7-14 天触发一次作为合理频率。

**如果不做**：
/digest 继续是半残功能，PROFILE.md 要靠 AI 在普通对话中随机写入（不可靠），candidates.md 里的候选永远不会被晋升，patterns/ 几乎不可能被填充。新建的所有文件结构只是空壳，改动1-7的价值全部打折扣。没有 /digest，整套系统是单向流入，没有提炼输出，时间越长越混乱。

**建议**：做，这是整套改造里最高优先级的改动之一。这是所有改动的"最终出口"，没有它其他改动都只是在做准备。

---

## 改动9：修改 L1 /.claude/CLAUDE.md（系统宪法）

**改什么**：修改系统宪法，让新结构有规则支撑。这是 C 类变更，最高风险。

需要修改的具体位置：

**`<SYSTEM_MAP>` 段**：在 5-Identity 描述里加入 PROFILE.md：
```
5-Identity/  - 身份画像（TELOS）+ 场景化偏好（PROFILE），文件级分级见 L2
```

**`<MEMORY_PROTOCOL>` 段**：在"长期记忆（半自动）"后增加 PROFILE.md 写入规则和冲突检测逻辑：
```
场景化偏好（半自动）：
  AI 在对话中观察到新偏好时，写入 candidates.md（A类，不注入上下文）。
  /digest 触发时，展示候选让用户确认，确认后晋升到 PROFILE.md 或 MEMORY.md。
  发现与已有条目冲突时：
    1. 先尝试场景化：确认是否是不同场景下的不同偏好
    2. 场景化成功 → 合并成"A情境-X偏好，B情境-Y偏好"
    3. 场景化失败 → 升B类，写入 pending_approvals.md
```

**`<CAPABILITIES>` 段**：知识库卫生里加 patterns/ 的写入时机说明：
- 复杂任务成功完成、用户明确触发、/digest 提取时 → 写入 patterns/

**如果做了**：
- 体验变化：AI 在任何 session 都能正确理解新结构，知道新偏好要写 candidates.md，知道冲突要先场景化，知道 PROFILE.md 存已确认偏好。这是让改动1-8在每次 session 里自然生效的前提。
- 好处：新建的 PROFILE.md、candidates.md 和 patterns/ 目录有了规则支撑，AI 行为可预测且一致；L1 规则更新后，即使新开一个 session，AI 也会按新结构行事。
- 坏处/风险：**L1 改错的代价最高。** 如果规则写得有歧义，或和现有规则冲突，会影响所有 session 的 AI 行为，而且可能很久之后才发现异常（静默降级）；这是 C 类变更，影响范围最广，无法局部测试；L1 内容变长也会轻微增加每次 session 的 token 消耗（约数百 token，可接受）。
- 维护负担：修改前必须列出每个改动点让用户逐条确认；通过 git 历史可以还原（这是唯一的安全网）。

**如果不做**：
PROFILE.md 建了，但 AI 不知道偏好先写 candidates.md 再晋升；patterns/ 建了但 AI 不知道什么时候写，会忽视它；新目录创造了，但 AI 的行为逻辑没有跟上。等于花时间建了结构，但系统没有真正采纳这套结构。

**建议**：做，但必须谨慎——改之前在文档里列出每个改动点（改哪一段、改成什么），用户逐条确认后分段执行。不要一次性大改，先改 SYSTEM_MAP 和 MEMORY_PROTOCOL，观察无问题再改 CAPABILITIES。

---

## 第三部分：执行顺序（修正版）

### 阶段零：修复现有 bug（独立，不依赖其他改动）
- 修复 approve_change.sh 和 pending_approvals.md 的格式不匹配
  - 将 pending_approvals.md 里的 `### 提案 #` 改为 `## 提案 #`
  - 或修改脚本匹配 `### 提案 #`（选一种，保持一致）
  - 统一字段格式：`- **类型**:` 改为 `- 类型：`（或反向统一）

### 阶段一：建立新结构（低风险，先做，每步间隔 2-3 天观察）
1. 新建 5-Identity/PROFILE.md（内容见改动1模板）→ B类审批（5-Identity 新文件）
2. 新建 6-System/memory/candidates.md（内容见改动3模板）→ A类
3. 新建 6-System/patterns/ + patterns/CLAUDE.md → A类
4. 更新 settings.json：加入 PROFILE.md → A类

### 阶段二：文档同步（中等风险）
5. 更新 5-Identity/CLAUDE.md：加 PROFILE.md、删"任何变更必须审批"误导行 → B类
6. 更新 6-System/CLAUDE.md 和 6-System/memory/CLAUDE.md → A类

### 阶段三：内容迁移（中等风险）
7. MEMORY.md 写作风格偏好迁移到 PROFILE.md，删除 MEMORY.md 中与 TELOS/AI_RULES 重叠的条目

### 阶段四：自动化升级（需要技术改动）
8. 升级 /digest SKILL.md：写入目标加 PROFILE.md 和 candidates.md，加入候选晋升工作流
9. 新建 session_export.py hook（全量对话 MD 导出到 session_logs/）

### 阶段五（最高风险，充分观察后再做）
10. 修改 L1 /.claude/CLAUDE.md（C类，逐段确认）
11. 可选：实施指针注入方案（待系统内容增长后评估）

每个阶段之间建议间隔观察 2-3 天，用真实 session 验证改动是否达到预期效果，再进入下一阶段。不要一次性全部执行。

---

## 第四部分：不在本次范围内的改动

**daily 文件格式**：不改，stop_audit.py 不动。现有 daily 记录质量的问题暂时搁置，本次方案不依赖 daily 格式改善。

**月压缩自动化**：不做，靠手动 /digest。当前数据量不大，自动压缩带来的复杂度和风险大于收益，等真正需要时再考虑。

**完整 transcript 复制**：不做。CC 本身可以找到原始记录，复制到知识库是纯粹冗余，浪费存储和维护成本。

---

## 第五部分：自动注入优化（指针视角）

### 当前状态：全量注入

settings.json 里的 contextFiles 目前每次 session 启动自动全量注入：

| 文件 | 大小 | 每次都需要吗？ |
|------|------|--------------|
| TELOS.md | ~250行 | 不一定，大多数任务用不上使命和信念层 |
| AI_RULES.md | ~70行 | 是，行为规则每次都需要 |
| CONTEXT.md | ~40行 | 是，当前状态每次都需要 |
| MEMORY.md | ~30行 | 通常需要，但主要是操作性规则 |
| PROFILE.md（新增） | 增长中 | 写作/创意任务需要，纯技术任务不需要 |

问题：无论你在做什么，全部内容都注入，浪费 context，且随着系统增长会越来越重。

---

### 优化方向：分层注入（常驻层 + 指针层）

**常驻层（每次全量注入，小且高密度）：**
```json
"contextFiles": [
  "5-Identity/AI_RULES.md",      // 行为规则，永远需要
  "5-Identity/CONTEXT.md",       // 当前状态，永远需要
  "6-System/memory/context_brief.md"  // 新建：其他所有内容的摘要+指针
]
```

**指针层（context_brief.md）：**
```markdown
# 快速索引

## 你是谁（详见 → 5-Identity/TELOS.md）
奥一，ENFP，建筑转 AI，正在做 MyWear 和外挂大脑系统。
核心信念：AI native、独立是自由的操作系统、真实行动比精密认知更值钱。
使命：帮人做更好判断，让认知转化为可验证行动。

## 场景偏好（详见 → 5-Identity/PROFILE.md）
写作：接地气类比，画面感情感节点，结尾给愿景不用 CTA，基调"内容要硬表达要人"。
交互：结论前置，先方案后执行，用类比理解抽象概念。
任务：系统配置选一次性永久方案，新任务先给方案不直接动手。

## 操作性规则（详见 → 6-System/memory/MEMORY.md）
文件命名：YYYYMM-DDHHMM-标题.md，用 date 拿时间戳。
```

**展开规则（写入 L1 CLAUDE.md）：**
```
遇到以下情况，主动 Read 对应文件：
- 涉及使命/目标/信念/决策框架 → 读 TELOS.md
- 涉及写作/创意/内容创作 → 读 PROFILE.md
- 触发 /digest 或偏好相关问题 → 读 PROFILE.md 和 candidates.md
- 涉及操作规则/命名/流程 → 读 MEMORY.md
```

---

### 利弊分析

**如果实施指针注入：**
- 体验变化：每次 session 启动更轻量；但遇到需要展开的任务，Claude 要多读一次文件（通常感知不到延迟）
- 好处：context 窗口更多留给实际工作；系统可以增长更多内容而不影响基础效率
- 坏处：如果 L1 的展开规则不够精确，Claude 可能在该展开时没展开（偏好不生效）
- 维护负担：context_brief.md 需要和源文件保持同步（每次更新 PROFILE.md 也要更新 brief）

**如果不实施（维持全量注入）：**
- 现在内容少，全量注入约 400 行，不算重，影响小
- 随着 PROFILE.md 增长，未来可能变成问题
- 简单可靠，不需要额外维护 brief 文件

**建议：现阶段不急于实施。** 先把改动1-9（结构调整）做好，系统跑稳后，如果 PROFILE.md 内容增长到 100 行以上，再切换到指针方案。

---

### 实施指针方案需要的额外工作

1. 新建 `6-System/memory/context_brief.md`（需要人工写一次初始内容）
2. 修改 settings.json contextFiles（去掉 TELOS.md 和 PROFILE.md，加入 context_brief.md）
3. 修改 L1 /.claude/CLAUDE.md：加入文件展开规则
4. 建立维护规范：更新 PROFILE.md 时同步更新 context_brief.md 对应摘要行
